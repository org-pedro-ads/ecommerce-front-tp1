<app-header></app-header>

<div class="layout-container">

  <app-sidebar></app-sidebar>

  <main class="content-area">
    
    <div class="container">
      <header class="page-header">
        <div class="page-header__icon">
          <lucide-icon name="shopping-cart"></lucide-icon>
        </div>

        <div>
          <h1 class="page-header__title">Carrinho de Compras</h1>
          <p class="page-header__subtitle">Revise seus itens e finalize seu pedido</p>
        </div>
      </header>

      @if (itensCart() === null) {
        <section class="empty-state">
          <h3 class="empty-state__title">Nenhum item no carrinho</h3>
          <p class="empty-state__description">Adicione produtos ao seu carrinho para continuar comprando.</p>

          <button class="btn btn--primary" (click)="navigate('products/catalog')">
            Ver Produtos
          </button>
        </section>
      }

      @else {
        <section class="cart-layout">

          <div class="cart-items-list">
            @for (item of itensCart()!.itens; track item.id) {

              <article class="cart-item">
                <div class="cart-item__content">

                  <div class="cart-item__image">
                    <lucide-icon name="shopping-cart"></lucide-icon>
                  </div>

                  <div class="cart-item__details">
                    <h3 class="cart-item__name">{{ item.produto.nome }}</h3>

                    <p class="cart-item__price">
                      {{ item.preco | currency:'BRL':'symbol':'1.2-2' }} / unidade
                    </p>

                    <div class="cart-item__footer">
                      <app-quantidade-controle 
                        [contador]="item.quantidade" 
                        (contadorChange)="changeQuantity(item.produto.id, item.quantidade, $event)">
                      </app-quantidade-controle>
                      
                      <strong class="cart-item__total">
                        {{ item.subTotal | currency:'BRL':'symbol':'1.2-2' }}
                      </strong>
                    </div>
                  </div>

                  <button class="cart-item__remove" (click)="removeFromCart(item.id)">
                    <lucide-icon name="Trash2"></lucide-icon>
                  </button>
                </div>
              </article>

            }
          </div>

          <aside class="cart-sidebar">
            <div class="order-summary">
              <h2 class="order-summary__title">Resumo do Pedido</h2>

              <div class="order-summary__content">
                <div class="summary-row">
                  <span>Subtotal</span>
                  <span>{{ subtotal() | currency:'BRL' }}</span>
                </div>

                <div class="summary-row">
                  <span>Taxas (10%)</span>
                  <span>{{ taxes() | currency:'BRL' }}</span>
                </div>

                <div class="summary-row summary-row--total">
                  <span>Total</span>
                  <span>{{ total() | currency:'BRL' }}</span>
                </div>
              </div>

              <button class="btn btn--primary" (click)="checkout()">
                Finalizar Pedido
              </button>

              <button class="btn btn--secondary" (click)="navigate('products/catalog')">
                Continuar Comprando
              </button>
            </div>
          </aside>

        </section>
      }
    </div>
  </main>
</div>

<app-footer></app-footer>